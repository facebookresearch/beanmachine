<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>beanmachine.ppl.inference &mdash; BeanMachine  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="beanmachine.ppl.inference.base_inference" href="beanmachine.ppl.inference.base_inference.html" />
    <link rel="prev" title="beanmachine.ppl.examples.conjugate_models.normal_normal" href="beanmachine.ppl.examples.conjugate_models.normal_normal.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BeanMachine
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="beanmachine.html">beanmachine</a></li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.html">beanmachine.ppl</a></li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.conftest.html">beanmachine.ppl.conftest</a></li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.diagnostics.html">beanmachine.ppl.diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.distribution.html">beanmachine.ppl.distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.examples.html">beanmachine.ppl.examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">beanmachine.ppl.inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.base_inference.html">beanmachine.ppl.inference.base_inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.bmg_inference.html">beanmachine.ppl.inference.bmg_inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.compositional_infer.html">beanmachine.ppl.inference.compositional_infer</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.hmc_inference.html">beanmachine.ppl.inference.hmc_inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html">beanmachine.ppl.inference.monte_carlo_samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.html">beanmachine.ppl.inference.proposer</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.sampler.html">beanmachine.ppl.inference.sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.single_site_ancestral_mh.html">beanmachine.ppl.inference.single_site_ancestral_mh</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.single_site_inference.html">beanmachine.ppl.inference.single_site_inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.single_site_nmc.html">beanmachine.ppl.inference.single_site_nmc</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.single_site_random_walk.html">beanmachine.ppl.inference.single_site_random_walk</a></li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.single_site_uniform_mh.html">beanmachine.ppl.inference.single_site_uniform_mh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-beanmachine.ppl.inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.model.html">beanmachine.ppl.model</a></li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.world.html">beanmachine.ppl.world</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BeanMachine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="beanmachine.html">beanmachine</a> &raquo;</li>
          <li><a href="beanmachine.ppl.html">beanmachine.ppl</a> &raquo;</li>
      <li>beanmachine.ppl.inference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/beanmachine.ppl.inference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="beanmachine-ppl-inference">
<h1>beanmachine.ppl.inference<a class="headerlink" href="#beanmachine-ppl-inference" title="Permalink to this headline"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.base_inference.html">beanmachine.ppl.inference.base_inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.base_inference.html#module-beanmachine.ppl.inference.base_inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.bmg_inference.html">beanmachine.ppl.inference.bmg_inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.bmg_inference.html#module-beanmachine.ppl.inference.bmg_inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.compositional_infer.html">beanmachine.ppl.inference.compositional_infer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.compositional_infer.html#module-beanmachine.ppl.inference.compositional_infer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.hmc_inference.html">beanmachine.ppl.inference.hmc_inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.hmc_inference.html#module-beanmachine.ppl.inference.hmc_inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html">beanmachine.ppl.inference.monte_carlo_samples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#module-beanmachine.ppl.inference.monte_carlo_samples">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.proposer.html">beanmachine.ppl.inference.proposer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.proposer.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_proposer.html">beanmachine.ppl.inference.proposer.base_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_proposer.html#module-beanmachine.ppl.inference.proposer.base_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_single_site_proposer.html">beanmachine.ppl.inference.proposer.base_single_site_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_single_site_proposer.html#module-beanmachine.ppl.inference.proposer.base_single_site_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.hmc_proposer.html">beanmachine.ppl.inference.proposer.hmc_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.hmc_proposer.html#module-beanmachine.ppl.inference.proposer.hmc_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.hmc_utils.html">beanmachine.ppl.inference.proposer.hmc_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.hmc_utils.html#module-beanmachine.ppl.inference.proposer.hmc_utils">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.nmc.html">beanmachine.ppl.inference.proposer.nmc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.nmc.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.nmc.html#module-beanmachine.ppl.inference.proposer.nmc">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.nuts_proposer.html">beanmachine.ppl.inference.proposer.nuts_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.nuts_proposer.html#module-beanmachine.ppl.inference.proposer.nuts_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.sequential_proposer.html">beanmachine.ppl.inference.proposer.sequential_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.sequential_proposer.html#module-beanmachine.ppl.inference.proposer.sequential_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.single_site_ancestral_proposer.html">beanmachine.ppl.inference.proposer.single_site_ancestral_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.single_site_ancestral_proposer.html#module-beanmachine.ppl.inference.proposer.single_site_ancestral_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.single_site_random_walk_proposer.html">beanmachine.ppl.inference.proposer.single_site_random_walk_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.single_site_random_walk_proposer.html#module-beanmachine.ppl.inference.proposer.single_site_random_walk_proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="beanmachine.ppl.inference.proposer.single_site_uniform_proposer.html">beanmachine.ppl.inference.proposer.single_site_uniform_proposer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="beanmachine.ppl.inference.proposer.single_site_uniform_proposer.html#module-beanmachine.ppl.inference.proposer.single_site_uniform_proposer">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.proposer.html#module-beanmachine.ppl.inference.proposer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.sampler.html">beanmachine.ppl.inference.sampler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.sampler.html#module-beanmachine.ppl.inference.sampler">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.single_site_ancestral_mh.html">beanmachine.ppl.inference.single_site_ancestral_mh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.single_site_ancestral_mh.html#module-beanmachine.ppl.inference.single_site_ancestral_mh">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.single_site_inference.html">beanmachine.ppl.inference.single_site_inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.single_site_inference.html#module-beanmachine.ppl.inference.single_site_inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.single_site_nmc.html">beanmachine.ppl.inference.single_site_nmc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.single_site_nmc.html#module-beanmachine.ppl.inference.single_site_nmc">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.single_site_random_walk.html">beanmachine.ppl.inference.single_site_random_walk</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.single_site_random_walk.html#module-beanmachine.ppl.inference.single_site_random_walk">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beanmachine.ppl.inference.single_site_uniform_mh.html">beanmachine.ppl.inference.single_site_uniform_mh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="beanmachine.ppl.inference.single_site_uniform_mh.html#module-beanmachine.ppl.inference.single_site_uniform_mh">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="module-beanmachine.ppl.inference">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-beanmachine.ppl.inference" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">BMGInference</span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interface to Bean Machine Graph (BMG) Inference,
an experimental framework for high-performance implementations of
inference algorithms.</p>
<p>Internally, BMGInference consists of a compiler
and C++ runtime implementations of various inference algorithms. Currently,
only Newtonian Monte Carlo (NMC) inference is supported, and is the
algorithm used by default.</p>
<p>Please note that this is a highly experimental implementation under active
development, and that the subset of Bean Machine model is limited. Limitations
include that the runtime graph should be static (meaning, it does not change
during inference), and that the types of primitive distributions supported
is currently limited.</p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">queries:</span> <span class="pre">List[beanmachine.ppl.model.rv_identifier.RVIdentifier],</span> <span class="pre">observations:</span> <span class="pre">Dict[beanmachine.ppl.model.rv_identifier.RVIdentifier,</span> <span class="pre">torch.Tensor],</span> <span class="pre">num_samples:</span> <span class="pre">int,</span> <span class="pre">num_chains:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">4,</span> <span class="pre">inference_type:</span> <span class="pre">beanmachine.graph.InferenceType</span> <span class="pre">=</span> <span class="pre">&lt;InferenceType.NMC:</span> <span class="pre">3&gt;,</span> <span class="pre">skip_optimizations:</span> <span class="pre">Set[str]</span> <span class="pre">=</span> <span class="pre">{'BetaBernoulliConjugateFixer',</span> <span class="pre">'BetaBinomialConjugateFixer',</span> <span class="pre">'NormalNormalConjugateFixer'}</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference.infer" title="Permalink to this definition"></a></dt>
<dd><p>Perform inference by (runtime) compilation of Python source code associated
with its parameters, constructing a BMG graph, and then calling the
BMG implementation of a particular inference method on this graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queries</strong> – queried random variables</p></li>
<li><p><strong>observations</strong> – observations dict</p></li>
<li><p><strong>num_samples</strong> – number of samples in each chain</p></li>
<li><p><strong>num_chains</strong> – number of chains generated</p></li>
<li><p><strong>inference_type</strong> – inference method, currently only NMC is supported</p></li>
<li><p><strong>skip_optimizations</strong> – list of optimization to disable in this call</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The requested samples</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples">MonteCarloSamples</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference.to_cpp">
<span class="sig-name descname"><span class="pre">to_cpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference.to_cpp" title="Permalink to this definition"></a></dt>
<dd><p>Produce a string containing a C++ program fragment which
produces the graph deduced from the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference.to_dot">
<span class="sig-name descname"><span class="pre">to_dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_transform</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_edges</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_optimizations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{'BetaBernoulliConjugateFixer',</span> <span class="pre">'BetaBinomialConjugateFixer',</span> <span class="pre">'NormalNormalConjugateFixer'}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference.to_dot" title="Permalink to this definition"></a></dt>
<dd><p>Produce a string containing a program in the GraphViz DOT language
representing the graph deduced from the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference.to_graph">
<span class="sig-name descname"><span class="pre">to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">beanmachine.graph.Graph</span><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference.to_graph" title="Permalink to this definition"></a></dt>
<dd><p>Produce a BMG graph and a map from queried RVIdentifiers to the corresponding
indices of the inference results.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference.to_graphviz">
<span class="sig-name descname"><span class="pre">to_graphviz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_transform</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_edges</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_optimizations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{'BetaBernoulliConjugateFixer',</span> <span class="pre">'BetaBinomialConjugateFixer',</span> <span class="pre">'NormalNormalConjugateFixer'}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">graphviz.sources.Source</span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference.to_graphviz" title="Permalink to this definition"></a></dt>
<dd><p>Small wrapper to generate an actual graphviz object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.BMGInference.to_python">
<span class="sig-name descname"><span class="pre">to_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.BMGInference.to_python" title="Permalink to this definition"></a></dt>
<dd><p>Produce a string containing a Python program fragment which
produces the graph deduced from the model.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.CompositionalInference">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">CompositionalInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proposers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.CompositionalInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.legacy.inference.abstract_mh_infer.AbstractMHInference</span></code></p>
<p>Compositional inference</p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.CompositionalInference.add_sequential_proposer">
<span class="sig-name descname"><span class="pre">add_sequential_proposer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.CompositionalInference.add_sequential_proposer" title="Permalink to this definition"></a></dt>
<dd><p>Adds a sequential block to list of blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block</strong> – list of random variables functions that are to be sampled
together sequentially.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.CompositionalInference.find_best_single_site_proposer">
<span class="sig-name descname"><span class="pre">find_best_single_site_proposer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.CompositionalInference.find_best_single_site_proposer" title="Permalink to this definition"></a></dt>
<dd><p>Finds the best proposer for a node given the proposer dicts passed in
once instantiating the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – the node for which to return a proposer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a proposer for the node</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.GlobalHamiltonianMonteCarlo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">GlobalHamiltonianMonteCarlo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory_length</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_step_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_step_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_mass_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept_prob</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.GlobalHamiltonianMonteCarlo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="beanmachine.ppl.inference.base_inference.html#beanmachine.ppl.inference.base_inference.BaseInference" title="beanmachine.ppl.inference.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.inference.base_inference.BaseInference</span></code></a></p>
<p>Global (multi-site) Hamiltonian Monte Carlo [1] sampler. This global sampler blocks all of the
target random_variables in the World together and proposes them jointly.</p>
<p>[1] Neal, Radford. <cite>MCMC Using Hamiltonian Dynamics</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory_length</strong> (<em>float</em>) – Length of single trajectory.</p></li>
<li><p><strong>initial_step_size</strong> (<em>float</em>) – Defaults to 1.0.</p></li>
<li><p><strong>adapt_step_size</strong> (<em>bool</em>) – Whether to adapt the step size, Defaults to True,</p></li>
<li><p><strong>adapt_mass_matrix</strong> (<em>bool</em>) – Whether to adapt the mass matrix. Defaults to True,</p></li>
<li><p><strong>target_accept_prob</strong> (<em>float</em>) – Target accept prob. Increasing this value would lead to smaller step size. Defaults to 0.8.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.GlobalHamiltonianMonteCarlo.get_proposers">
<span class="sig-name descname"><span class="pre">get_proposers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">world</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.world.world.html#beanmachine.ppl.world.world.World" title="beanmachine.ppl.world.world.World"><span class="pre">beanmachine.ppl.world.world.World</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rvs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_adaptive_sample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_proposer.html#beanmachine.ppl.inference.proposer.base_proposer.BaseProposer" title="beanmachine.ppl.inference.proposer.base_proposer.BaseProposer"><span class="pre">beanmachine.ppl.inference.proposer.base_proposer.BaseProposer</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.GlobalHamiltonianMonteCarlo.get_proposers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.GlobalNoUTurnSampler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">GlobalNoUTurnSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_tree_depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_delta_energy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_step_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_step_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adapt_mass_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multinomial_sampling</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept_prob</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.GlobalNoUTurnSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="beanmachine.ppl.inference.base_inference.html#beanmachine.ppl.inference.base_inference.BaseInference" title="beanmachine.ppl.inference.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.inference.base_inference.BaseInference</span></code></a></p>
<p>Global No U-turn sampler [1]. This sampler blocks multiple variables together in the World
and samples them jointly. This sampler adaptively sets the hyperparameters of the HMC kernel.</p>
<p>[1] Hoffman and Gelman. <cite>The No-U-turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo</cite>.
[2] Betancourt, Michael. <cite>A Conceptual Introduction to Hamiltonian Monte Carlo</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_tree_depth</strong> (<em>int</em>) – Maximum tree depth, defaults to 10.</p></li>
<li><p><strong>max_delta_energy</strong> (<em>float</em>) – Maximum delta energy (for numerical stability), defaults to 1000.</p></li>
<li><p><strong>initial_step_size</strong> (<em>float</em>) – Defaults to 1.0.</p></li>
<li><p><strong>adapt_step_size</strong> (<em>bool</em>) – Whether to adapt step size with Dual averaging as suggested in [1], defaults to True.</p></li>
<li><p><strong>adapt_mass_matrix</strong> (<em>bool</em>) – </p></li>
<li><p><strong>multinomial_sampling</strong> (<em>bool</em>) – Whether to use multinomial sampling as in [2], defaults to True.</p></li>
<li><p><strong>target_accept_prob</strong> (<em>float</em>) – Target accept probability. Increasing this would lead to smaller step size. Defaults to 0.8.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.GlobalNoUTurnSampler.get_proposers">
<span class="sig-name descname"><span class="pre">get_proposers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">world</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.world.world.html#beanmachine.ppl.world.world.World" title="beanmachine.ppl.world.world.World"><span class="pre">beanmachine.ppl.world.world.World</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rvs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_adaptive_sample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_proposer.html#beanmachine.ppl.inference.proposer.base_proposer.BaseProposer" title="beanmachine.ppl.inference.proposer.base_proposer.BaseProposer"><span class="pre">beanmachine.ppl.inference.proposer.base_proposer.BaseProposer</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.GlobalNoUTurnSampler.get_proposers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.Predictive">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">Predictive</span></span><a class="headerlink" href="#beanmachine.ppl.inference.Predictive" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for the posterior predictive distribution.</p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.Predictive.empirical">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">empirical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></span><a class="headerlink" href="#beanmachine.ppl.inference.Predictive.empirical" title="Permalink to this definition"></a></dt>
<dd><p>Samples from the empirical (marginal) distribution of the queried variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queries</strong> – list of <cite>random_variable</cite>’s to be sampled.</p></li>
<li><p><strong>samples</strong> – <cite>MonteCarloSamples</cite> of the distribution.</p></li>
<li><p><strong>num_samples</strong> – Number of samples to sample (with replacement). Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>MonteCarloSamples</cite> object containing the sampled random variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.Predictive.simulate">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorized</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></span><a class="headerlink" href="#beanmachine.ppl.inference.Predictive.simulate" title="Permalink to this definition"></a></dt>
<dd><p>Generates predictives from a generative model.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obs_queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">likelihood</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))]</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">SinglesiteHamiltonianMonteCarlo</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="c1"># generates one sample per world (same shape as `posterior` samples)</span>
<span class="n">predictives</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">obs_queries</span><span class="p">,</span> <span class="n">posterior</span><span class="o">=</span><span class="n">posterior</span><span class="p">)</span>
</pre></div>
</div>
<p>To generate prior predictives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">prior</span><span class="p">(),</span> <span class="n">likelihood</span><span class="p">()]</span>  <span class="c1"># specify the full generative model</span>
<span class="c1"># Monte carlo samples of shape (num_samples, sample_shape)</span>
<span class="n">predictives</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – list of <cite>random_variable</cite>’s corresponding to the observations.</p></li>
<li><p><strong>posterior</strong> – Optional <cite>MonteCarloSamples</cite> of the latent variables.</p></li>
<li><p><strong>num_samples</strong> – Number of prior predictive samples, defaults to 1. Should
not be specified if <cite>posterior</cite> is specified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>MonteCarloSamples</cite> of the generated predictives.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.RejectionSampling">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">RejectionSampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_attempts_per_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.RejectionSampling" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.legacy.inference.abstract_infer.AbstractMCInference</span></code></p>
<p>Inference object for rejection sampling inference. ABC inference
algorithms will inherit from this class, and override the single_inference_step method</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteAncestralMetropolisHastings">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">SingleSiteAncestralMetropolisHastings</span></span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteAncestralMetropolisHastings" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="beanmachine.ppl.inference.single_site_inference.html#beanmachine.ppl.inference.single_site_inference.SingleSiteInference" title="beanmachine.ppl.inference.single_site_inference.SingleSiteInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.inference.single_site_inference.SingleSiteInference</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteHamiltonianMonteCarlo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">SingleSiteHamiltonianMonteCarlo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_length</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">beanmachine.ppl.legacy.world.variable.TransformType</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">TransformType.DEFAULT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteHamiltonianMonteCarlo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.legacy.inference.abstract_mh_infer.AbstractMHInference</span></code></p>
<p>Implementation for SingleSiteHamiltonianMonteCarlo</p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteHamiltonianMonteCarlo.find_best_single_site_proposer">
<span class="sig-name descname"><span class="pre">find_best_single_site_proposer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteHamiltonianMonteCarlo.find_best_single_site_proposer" title="Permalink to this definition"></a></dt>
<dd><p>Finds the best proposer for a node which is
SingleSiteHamiltonianMonteCarloProposer for SingleSiteHamiltonianMonteCarlo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – the node for which to return a proposer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a proposer for the node</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteNewtonianMonteCarlo">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">SingleSiteNewtonianMonteCarlo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real_space_alpha</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_space_beta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteNewtonianMonteCarlo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="beanmachine.ppl.inference.base_inference.html#beanmachine.ppl.inference.base_inference.BaseInference" title="beanmachine.ppl.inference.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.inference.base_inference.BaseInference</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteNewtonianMonteCarlo.get_proposers">
<span class="sig-name descname"><span class="pre">get_proposers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">world</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.world.world.html#beanmachine.ppl.world.world.World" title="beanmachine.ppl.world.world.World"><span class="pre">beanmachine.ppl.world.world.World</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rvs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_adaptive_sample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_proposer.html#beanmachine.ppl.inference.proposer.base_proposer.BaseProposer" title="beanmachine.ppl.inference.proposer.base_proposer.BaseProposer"><span class="pre">beanmachine.ppl.inference.proposer.base_proposer.BaseProposer</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteNewtonianMonteCarlo.get_proposers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteNoUTurnSampler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">SingleSiteNoUTurnSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_dense_mass_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">beanmachine.ppl.legacy.world.variable.TransformType</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">TransformType.DEFAULT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteNoUTurnSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.legacy.inference.abstract_mh_infer.AbstractMHInference</span></code></p>
<p>Implementation for SingleSiteNoUTurnSampler</p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteNoUTurnSampler.find_best_single_site_proposer">
<span class="sig-name descname"><span class="pre">find_best_single_site_proposer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteNoUTurnSampler.find_best_single_site_proposer" title="Permalink to this definition"></a></dt>
<dd><p>Finds the best proposer for a node which is
SingleSiteHamiltonianMonteCarloProposer for SingleSiteHamiltonianMonteCarlo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – the node for which to return a proposer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a proposer for the node</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteRandomWalk">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">SingleSiteRandomWalk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteRandomWalk" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="beanmachine.ppl.inference.base_inference.html#beanmachine.ppl.inference.base_inference.BaseInference" title="beanmachine.ppl.inference.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.inference.base_inference.BaseInference</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteRandomWalk.get_proposers">
<span class="sig-name descname"><span class="pre">get_proposers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">world</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.world.world.html#beanmachine.ppl.world.world.World" title="beanmachine.ppl.world.world.World"><span class="pre">beanmachine.ppl.world.world.World</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_rvs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_adaptive_sample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.inference.proposer.base_proposer.html#beanmachine.ppl.inference.proposer.base_proposer.BaseProposer" title="beanmachine.ppl.inference.proposer.base_proposer.BaseProposer"><span class="pre">beanmachine.ppl.inference.proposer.base_proposer.BaseProposer</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteRandomWalk.get_proposers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.SingleSiteUniformMetropolisHastings">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">SingleSiteUniformMetropolisHastings</span></span><a class="headerlink" href="#beanmachine.ppl.inference.SingleSiteUniformMetropolisHastings" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="beanmachine.ppl.inference.single_site_inference.html#beanmachine.ppl.inference.single_site_inference.SingleSiteInference" title="beanmachine.ppl.inference.single_site_inference.SingleSiteInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">beanmachine.ppl.inference.single_site_inference.SingleSiteInference</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.VerboseLevel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">VerboseLevel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#beanmachine.ppl.inference.VerboseLevel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Enum class which is used to set how much output is printed during inference.
LOAD_BAR enables tqdm for full inference loop.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.VerboseLevel.LOAD_BAR">
<span class="sig-name descname"><span class="pre">LOAD_BAR</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#beanmachine.ppl.inference.VerboseLevel.LOAD_BAR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.VerboseLevel.OFF">
<span class="sig-name descname"><span class="pre">OFF</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0</span></em><a class="headerlink" href="#beanmachine.ppl.inference.VerboseLevel.OFF" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.empirical">
<span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">empirical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></span><a class="headerlink" href="#beanmachine.ppl.inference.empirical" title="Permalink to this definition"></a></dt>
<dd><p>Samples from the empirical (marginal) distribution of the queried variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queries</strong> – list of <cite>random_variable</cite>’s to be sampled.</p></li>
<li><p><strong>samples</strong> – <cite>MonteCarloSamples</cite> of the distribution.</p></li>
<li><p><strong>num_samples</strong> – Number of samples to sample (with replacement). Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>MonteCarloSamples</cite> object containing the sampled random variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.seed">
<span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#beanmachine.ppl.inference.seed" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="beanmachine.ppl.inference.simulate">
<span class="sig-prename descclassname"><span class="pre">beanmachine.ppl.inference.</span></span><span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.model.rv_identifier.html#beanmachine.ppl.model.rv_identifier.RVIdentifier" title="beanmachine.ppl.model.rv_identifier.RVIdentifier"><span class="pre">beanmachine.ppl.model.rv_identifier.RVIdentifier</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorized</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="beanmachine.ppl.inference.monte_carlo_samples.html#beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples" title="beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples"><span class="pre">beanmachine.ppl.inference.monte_carlo_samples.MonteCarloSamples</span></a></span></span><a class="headerlink" href="#beanmachine.ppl.inference.simulate" title="Permalink to this definition"></a></dt>
<dd><p>Generates predictives from a generative model.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obs_queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">likelihood</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))]</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">SinglesiteHamiltonianMonteCarlo</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="c1"># generates one sample per world (same shape as `posterior` samples)</span>
<span class="n">predictives</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">obs_queries</span><span class="p">,</span> <span class="n">posterior</span><span class="o">=</span><span class="n">posterior</span><span class="p">)</span>
</pre></div>
</div>
<p>To generate prior predictives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="n">prior</span><span class="p">(),</span> <span class="n">likelihood</span><span class="p">()]</span>  <span class="c1"># specify the full generative model</span>
<span class="c1"># Monte carlo samples of shape (num_samples, sample_shape)</span>
<span class="n">predictives</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – list of <cite>random_variable</cite>’s corresponding to the observations.</p></li>
<li><p><strong>posterior</strong> – Optional <cite>MonteCarloSamples</cite> of the latent variables.</p></li>
<li><p><strong>num_samples</strong> – Number of prior predictive samples, defaults to 1. Should
not be specified if <cite>posterior</cite> is specified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>MonteCarloSamples</cite> of the generated predictives.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="beanmachine.ppl.examples.conjugate_models.normal_normal.html" class="btn btn-neutral float-left" title="beanmachine.ppl.examples.conjugate_models.normal_normal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="beanmachine.ppl.inference.base_inference.html" class="btn btn-neutral float-right" title="beanmachine.ppl.inference.base_inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Facebook.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>