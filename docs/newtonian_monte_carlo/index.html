<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-47","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">Newtonian Monte Carlo | Bean Machine</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://beanmachine.org/docs/newtonian_monte_carlo/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Newtonian Monte Carlo | Bean Machine"><meta data-react-helmet="true" name="description" content="Newtonian Monte Carlo (NMC, Arora et al., 2020) is a second-order gradient-based Markov chain Monte Carlo (MCMC) algorithm that uses the first- and second-order gradients to propose a new value for a random variable."><meta data-react-helmet="true" property="og:description" content="Newtonian Monte Carlo (NMC, Arora et al., 2020) is a second-order gradient-based Markov chain Monte Carlo (MCMC) algorithm that uses the first- and second-order gradients to propose a new value for a random variable."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://beanmachine.org/docs/newtonian_monte_carlo/"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/newtonian_monte_carlo/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://beanmachine.org/docs/newtonian_monte_carlo/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.01a22e7d.css">
<link rel="preload" href="/assets/js/runtime~main.c26a0145.js" as="script">
<link rel="preload" href="/assets/js/main.badb2e6a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/why_bean_machine/">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials/">Tutorials</a><a href="/api/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">üåú</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">üåû</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Framework</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Inference Methods</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/inference/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ancestral_metropolis_hastings/">Single-Site Ancestral MH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/random_walk/">Single-Site Random Walk MH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uniform_metropolis_hastings/">Single-Site Uniform MH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hamiltonian_monte_carlo/">Hamiltonian Monte Carlo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/newtonian_monte_carlo/">Newtonian Monte Carlo</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Programmable Inference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Custom Proposers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Model Evaluation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Development</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Advanced</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorials/">Tutorials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/contributing/">Contributing Docs</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_XoVD"><div class="docItemContainer_6jsP"><article><header><h1 class="docTitle_ft6A">Newtonian Monte Carlo</h1></header><div class="markdown"><p>Newtonian Monte Carlo (NMC, Arora et al., 2020) is a second-order gradient-based Markov chain Monte Carlo (MCMC) algorithm that uses the first- and second-order gradients to propose a new value for a random variable.</p><p>To understand the idea behind NMC, we revisit two other common MCMC algorithms, <a href="/docs/random_walk/">Random Walk</a> and Metropolis-adjusted Langevin algorithm (MALA). In Random Walk, we propose the next parameter value <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi><mo>‚àà</mo><msup><mi mathvariant="double-struck">R</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\theta\in\R^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span></span></span></span></span></span></span></span></span> for our model using a simple Normal distribution centered at the current value: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo separator="true">,</mo><msup><mi>œµ</mi><mn>2</mn></msup><msub><mi>I</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(. \mid \theta) = \mathcal{N}(\theta, \epsilon^2I_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mopen">(</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em">N</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">œµ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>. This Normal distribution has covariance <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>œµ</mi><mn>2</mn></msup><msub><mi>I</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon^2I_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">œµ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">œµ</span></span></span></span></span> is the user-specified step size and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">I_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> ‚Äãis a <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>√ó</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> identity matrix (Metropolis et al., 1953). In cases where the target density, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span></span></span></span></span>, is differentiable, we can use the proposal distribution proposed by MALA which is <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo>+</mo><mfrac><msup><mi>œµ</mi><mn>2</mn></msup><mn>2</mn></mfrac><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>œµ</mi><mn>2</mn></msup><msub><mi>I</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(.|\theta)=\mathcal{N}(\theta+\frac{\epsilon^2}{2}\nabla \log\pi(\theta), \epsilon^2I_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em">N</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.36292em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01792em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">œµ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em"><span style="top:-2.931em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">œµ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> (Robert &amp; Tweedie, 1996). In MALA, we use a Normal distribution whose mean is <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msup><mi>œµ</mi><mn>2</mn></msup><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\epsilon^2}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.36292em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01792em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">œµ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em"><span style="top:-2.931em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>‚Äã away from the current value, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span></span></span></span></span>, in the direction of the first-order gradient of the target density, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span></span></span></span></span>. In both Random Walk and MALA, we have the problem of finding the correct step size. A large step size may lead to an ineffective exploration of the space and low acceptance rate. A small step size can lead to a high acceptance rate but slow exploration of the space.</p><p>In NMC, we follow the same intuition and try to overcome the problem of choosing the step size by using the second-order gradient information. NMC offers different proposers based on the support of the random variable <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span></span></span></span></span>, Real-Space proposer, Half-Space proposer and Simplex space proposer. One can also choose to transform the random variable <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span></span></span></span></span> from Half-Space or simplex into Real-Space and use the Real-Space proposer algorithm.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="nmc-proposers">NMC Proposers<a aria-hidden="true" class="hash-link" href="#nmc-proposers" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="real-space-proposer">Real-Space Proposer<a aria-hidden="true" class="hash-link" href="#real-space-proposer" title="Direct link to heading">‚Äã</a></h3><p>NMC uses a Multivariate Normal distribution to propose values in unconstrained space. Conceptually, NMC theorizes that the posterior is shaped like a Normal distribution. It uses first- and second-order gradient information from the current sample in order to build a proposal distribution whose shape matches that of this theoretical Normal distribution.</p><p>Mathematically, the proposal distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span></span> used as a function of the current sample location <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span></span></span></span></span> is: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo>‚àí</mo><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><msup><mo stretchy="false">)</mo><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>‚àí</mo><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><msup><mo stretchy="false">)</mo><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(. \mid \theta)=\mathcal{N}(\theta-\nabla^2 \log\pi(\theta)^{-1}\nabla \log\pi(\theta), -\nabla ^2\log\pi(\theta)^{-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mopen">(</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em">N</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em"></span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">‚àí</span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.</p><p>This proposal distribution works well the closer that the posterior is to a Normal distribution. However, in cases when the posterior is quite dissimilar to a Normal distribution, this proposer may overfit to its Normal assumption. To alleviate this, we introduce a &quot;learning rate&quot; <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Œ≥</span></span></span></span></span>, whose purpose is to reduce the strength of that Normal assumption when choosing a mean for the proposal distribution. The proposal distribution with the learning rate is: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo>‚àí</mo><mi>Œ≥</mi><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><msup><mo stretchy="false">)</mo><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>‚àí</mo><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><msup><mo stretchy="false">)</mo><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(. \mid \theta)=\mathcal{N}(\theta-\gamma\nabla^2 \log\pi(\theta)^{-1}\nabla \log\pi(\theta), -\nabla ^2\log\pi(\theta)^{-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mopen">(</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.14736em">N</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Œ≥</span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">‚àí</span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\gamma\in[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Œ≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Œ≥</span></span></span></span></span> is initially drawn from <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Beta</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Beta}(a, b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Beta</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span>, and an appropriate distribution for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Œ≥</span></span></span></span></span> is jointly learned with the rest of the model during inference (&quot;Riemann manifold MALA&quot;, Section 5 of Girolami &amp; Calderhead, 2011).</p><p>This proposer works for:</p><ol><li>Random variables with unconstrained space support.</li><li>Random variables with constrained space support that are transformed into unconstrained space.</li></ol><p>Subsequent sections will cover proposal distributions used in constrained spaces.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="half-space-proposer">Half-Space Proposer<a aria-hidden="true" class="hash-link" href="#half-space-proposer" title="Direct link to heading">‚Äã</a></h3><p>For random variables constrained with half-space support, NMC uses <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Gamma</mtext></mrow><annotation encoding="application/x-tex">\text{Gamma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord text"><span class="mord">Gamma</span></span></span></span></span></span> as the base proposal distribution, and fits its parameters using local first- and second-order gradient information.</p><p>Mathematically, it is: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>Gamma</mtext><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><msup><mi>Œ∏</mi><mn>2</mn></msup><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>‚àí</mo><mi>Œ∏</mi><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(. \mid \theta)=\text{Gamma}(1-\theta^2\nabla^2\log\pi(\theta), -\theta\nabla^2\log\pi(\theta)-\nabla \log\pi(\theta))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mopen">(</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Gamma</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">‚àí</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="simplex-proposer">Simplex Proposer<a aria-hidden="true" class="hash-link" href="#simplex-proposer" title="Direct link to heading">‚Äã</a></h3><p>For random variables constrained with simplex-valued support, NMC uses the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Dirichlet</mtext></mrow><annotation encoding="application/x-tex">\text{Dirichlet}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord text"><span class="mord">Dirichlet</span></span></span></span></span></span> distribution as the base proposal distribution, and fits its parameters using local first- and second-order gradient information.</p><p>For a <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span>-dimensional simplex, the proposal distribution is <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>Dirichlet</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>Œ±</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(. \mid \theta)=\text{Dirichlet}(x;\alpha)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mopen">(</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚à£</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Dirichlet</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="mclose">)</span></span></span></span></span>, where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>‚àà</mo><msup><mi mathvariant="double-struck">R</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">\alpha \in \mathbb{R}^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>‚àí</mo><msubsup><mi>Œ∏</mi><mi>i</mi><mn>2</mn></msubsup><mrow><mo fence="true">(</mo><msub><mi mathvariant="normal">‚àá</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi><munder><mo><mi>max</mi><mo>‚Å°</mo></mo><mrow><mi>i</mi><mo mathvariant="normal">‚â†</mo><mi>j</mi></mrow></munder></mi><msubsup><mi mathvariant="normal">‚àá</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_i = 1-\theta_i^2\left(\nabla_{ii}\log\pi(\theta)-\underset{i\neq j}{\max}\nabla_{ij}^2\log\pi(\theta)\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-2.441336em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em"><span style="top:-2.3478920000000003em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="inner"><span class="mrel mtight">ÓÄ†</span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mop">max</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882159999999999em"><span></span></span></span></span></span></span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">)</span></span></span></span></span></span></span>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="nmc-algorithm">NMC Algorithm<a aria-hidden="true" class="hash-link" href="#nmc-algorithm" title="Direct link to heading">‚Äã</a></h2><p>Below is the NMC algorithm.</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">Input:</mtext><mtext>¬†target¬†density¬†</mtext><mi>œÄ</mi><mtext>¬†defined¬†on¬†</mtext><msub><mi>Œ∏</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>Œ∏</mi><mi>k</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\textbf{Input:} \text{ target density } \pi \text{ defined on } \theta_1...\theta_k\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord text"><span class="mord textbf">Input:</span></span><span class="mord text"><span class="mord">¬†target¬†density¬†</span></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mord text"><span class="mord">¬†defined¬†on¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="bold">Given:</mtext><mtext>¬†</mtext></mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mtext>¬†(default¬†1,¬†1)</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\textbf{Given: } a, b \text{ (default 1, 1)}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textbf">Given:¬†</span></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">b</span><span class="mord text"><span class="mord">¬†(default¬†1,¬†1)</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">repeat</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\textbf{repeat}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8293600000000001em;vertical-align:-0.19444em"></span><span class="mord text"><span class="mord textbf">repeat</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">for</mtext><mtext>¬†</mtext></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mtext>¬†</mtext><mtext mathvariant="bold">to</mtext><mtext>¬†</mtext><mi>k</mi><mtext>¬†</mtext><mtext mathvariant="bold">do</mtext><mo>:</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad \textbf{for } i=1\ \textbf{to}\ k\ \textbf{do}:\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">for¬†</span></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord">1</span><span class="mspace">¬†</span><span class="mord text"><span class="mord textbf">to</span></span><span class="mspace">¬†</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace">¬†</span><span class="mord text"><span class="mord textbf">do</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mtext>¬†and¬†</mtext><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mtext>¬†w.r.t.¬†</mtext><msub><mi>Œ∏</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }\nabla \log\pi(\theta)\ \text{and}\ \nabla^2\log\pi(\theta)\ \text{w.r.t. }\theta_i\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mord text"><span class="mord">and</span></span><span class="mspace">¬†</span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mord text"><span class="mord">w.r.t.¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo><mtext>¬†as¬†explained¬†above</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }q_i(.|\theta) \text{ as explained above}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mord text"><span class="mord">¬†as¬†explained¬†above</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Sample¬†</mtext><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo>‚àº</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Sample }\theta^*\sim q_i(.|\theta)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Sample¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Set¬†</mtext><msubsup><mi>Œ∏</mi><mi>j</mi><mo>‚àó</mo></msubsup><mo>=</mo><msub><mi>Œ∏</mi><mi>j</mi></msub><mtext>¬†for¬†</mtext><mi>i</mi><mo mathvariant="normal">‚â†</mo><mi>j</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Set }\theta^*_j=\theta_j\text{ for }i\neq j\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0892119999999998em;vertical-align:-0.394772em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Set¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-2.441336em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">¬†for¬†</span></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05724em">j</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mtext>¬†and¬†</mtext><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mtext>¬†w.r.t.¬†</mtext><msubsup><mi>Œ∏</mi><mi>j</mi><mo>‚àó</mo></msubsup><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }\nabla \log\pi(\theta^*)\text{ and }\nabla^2\log\pi(\theta^*)\text{ w.r.t. }\theta_j^*\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20888em;vertical-align:-0.394772em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord text"><span class="mord">¬†and¬†</span></span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord text"><span class="mord">¬†w.r.t.¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-2.441336em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }q_i(.|\theta^*)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mi>Œ±</mi><mo>=</mo><mfrac><mrow><mi>œÄ</mi><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>Œ∏</mi><mi mathvariant="normal">‚à£</mi><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo></mrow><mrow><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo></mrow></mfrac><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\alpha=\frac{\pi(\theta^*)q_i(\theta|\theta^*)}{\pi(\theta)q_i(\theta^*|\theta)}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53934em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01934em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">œÄ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6183428571428571em"><span style="top:-2.786em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mord mtight">‚à£</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">œÄ</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7633428571428571em"><span style="top:-2.931em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="mord mtight">‚à£</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7633428571428571em"><span style="top:-2.931em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mi>u</mi><mo>‚àº</mo><mtext>Uniform</mtext><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad u\sim \text{Uniform}(0,1)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Uniform</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">if</mtext><mtext>¬†</mtext></mrow><mi>u</mi><mo>&lt;</mo><mi>Œ±</mi><mrow><mtext>¬†</mtext><mtext mathvariant="bold">then</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\textbf{if }u&lt;\alpha\textbf{ then}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">if¬†</span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="mord text"><span class="mord textbf">¬†then</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mspace width="1em"></mspace><mi>Œ∏</mi><mo>=</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\quad\theta=\theta^*\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">end</mtext><mtext>¬†</mtext><mtext mathvariant="bold">if</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\textbf{end if}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">end¬†if</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">end</mtext><mtext>¬†</mtext><mtext mathvariant="bold">for</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\textbf{end for}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">end¬†for</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mtext>Output¬†sample¬†</mtext><mi>Œ∏</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\text{Output sample }\theta\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Output¬†sample¬†</span></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="bold">until</mtext><mtext>¬†</mtext></mrow><mtext>Desired¬†number¬†of¬†samples</mtext></mrow><annotation encoding="application/x-tex">\textbf{until }\text{Desired number of samples}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord text"><span class="mord textbf">until¬†</span></span><span class="mord text"><span class="mord">Desired¬†number¬†of¬†samples</span></span></span></span></span></span></p><p>Below is NMC algorithm with adaptive stage added to compute the learning rate parameters <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">a</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal">b</span></span></span></span></span> for the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Beta</mtext></mrow><annotation encoding="application/x-tex">\text{Beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord text"><span class="mord">Beta</span></span></span></span></span></span> distribution.</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">Input:</mtext><mtext>¬†target¬†density¬†</mtext><mi>œÄ</mi><mtext>¬†defined¬†on¬†</mtext><msub><mi>Œ∏</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>Œ∏</mi><mi>k</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\textbf{Input:} \text{ target density } \pi \text{ defined on } \theta_1...\theta_k\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord text"><span class="mord textbf">Input:</span></span><span class="mord text"><span class="mord">¬†target¬†density¬†</span></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mord text"><span class="mord">¬†defined¬†on¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="bold">Given:</mtext><mtext>¬†</mtext></mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mtext>¬†(default¬†1,¬†1)</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\textbf{Given: } a, b \text{ (default 1, 1)}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord textbf">Given:¬†</span></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">b</span><span class="mord text"><span class="mord">¬†(default¬†1,¬†1)</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">repeat</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\textbf{repeat}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8293600000000001em;vertical-align:-0.19444em"></span><span class="mord text"><span class="mord textbf">repeat</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">for</mtext><mtext>¬†</mtext></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mtext>¬†</mtext><mtext mathvariant="bold">to</mtext><mtext>¬†</mtext><mi>k</mi><mtext>¬†</mtext><mtext mathvariant="bold">do</mtext><mo>:</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad \textbf{for } i=1\ \textbf{to}\ k\ \textbf{do}:\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">for¬†</span></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord">1</span><span class="mspace">¬†</span><span class="mord text"><span class="mord textbf">to</span></span><span class="mspace">¬†</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace">¬†</span><span class="mord text"><span class="mord textbf">do</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mtext>¬†and¬†</mtext><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><mtext>¬†w.r.t.¬†</mtext><msub><mi>Œ∏</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }\nabla \log\pi(\theta)\ \text{and}\ \nabla^2\log\pi(\theta)\ \text{w.r.t. }\theta_i\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mord text"><span class="mord">and</span></span><span class="mspace">¬†</span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mspace">¬†</span><span class="mord text"><span class="mord">w.r.t.¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">if</mtext><mtext>¬†</mtext></mrow><mtext>still¬†in¬†warm-up¬†phase</mtext><mrow><mtext>¬†</mtext><mtext mathvariant="bold">then</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\textbf{if }\text{still in warm-up phase}\textbf{ then}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">if¬†</span></span><span class="mord text"><span class="mord">still¬†in¬†warm-up¬†phase</span></span><span class="mord text"><span class="mord textbf">¬†then</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>Compute¬†</mtext><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mtext>¬†from¬†mean¬†and¬†variance¬†of¬†the¬†warmup¬†samples¬†using¬†method¬†of¬†moments</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\qquad\qquad \text{Compute } a, b \text{ from mean and variance of the warmup samples using method of moments} \\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">b</span><span class="mord text"><span class="mord">¬†from¬†mean¬†and¬†variance¬†of¬†the¬†warmup¬†samples¬†using¬†method¬†of¬†moments</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mrow><mtext mathvariant="bold">end</mtext><mtext>¬†</mtext><mtext mathvariant="bold">if</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\qquad \textbf{end if}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord textbf">end¬†if</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Sample¬†</mtext><mi>Œ≥</mi><mo>‚àº</mo><mtext>Beta</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Sample }\gamma\sim \text{Beta}(a,b)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Sample¬†</span></span><span class="mord mathnormal" style="margin-right:0.05556em">Œ≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Beta</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo><mtext>¬†as¬†explained¬†above</mtext><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }q_i(.|\theta) \text{ as explained above}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span><span class="mord text"><span class="mord">¬†as¬†explained¬†above</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Sample¬†</mtext><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo>‚àº</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Sample }\theta^*\sim q_i(.|\theta)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Sample¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Set¬†</mtext><msubsup><mi>Œ∏</mi><mi>j</mi><mo>‚àó</mo></msubsup><mo>=</mo><msub><mi>Œ∏</mi><mi>j</mi></msub><mtext>¬†for¬†</mtext><mi>i</mi><mo mathvariant="normal">‚â†</mo><mi>j</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Set }\theta^*_j=\theta_j\text{ for }i\neq j\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0892119999999998em;vertical-align:-0.394772em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Set¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-2.441336em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">¬†for¬†</span></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05724em">j</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><mi mathvariant="normal">‚àá</mi><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mtext>¬†and¬†</mtext><msup><mi mathvariant="normal">‚àá</mi><mn>2</mn></msup><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mtext>¬†w.r.t.¬†</mtext><msubsup><mi>Œ∏</mi><mi>j</mi><mo>‚àó</mo></msubsup><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }\nabla \log\pi(\theta^*)\text{ and }\nabla^2\log\pi(\theta^*)\text{ w.r.t. }\theta_j^*\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20888em;vertical-align:-0.394772em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord">‚àá</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord text"><span class="mord">¬†and¬†</span></span><span class="mord"><span class="mord">‚àá</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.03588em">œÄ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord text"><span class="mord">¬†w.r.t.¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-2.441336em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>Compute¬†</mtext><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">‚à£</mi><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\text{Compute }q_i(.|\theta^*)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Compute¬†</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">.</span><span class="mord">‚à£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mi>Œ±</mi><mo>=</mo><mfrac><mrow><mi>œÄ</mi><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>Œ∏</mi><mi mathvariant="normal">‚à£</mi><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mo stretchy="false">)</mo></mrow><mrow><mi>œÄ</mi><mo stretchy="false">(</mo><mi>Œ∏</mi><mo stretchy="false">)</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mi mathvariant="normal">‚à£</mi><mi>Œ∏</mi><mo stretchy="false">)</mo></mrow></mfrac><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\alpha=\frac{\pi(\theta^*)q_i(\theta|\theta^*)}{\pi(\theta)q_i(\theta^*|\theta)}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.53934em;vertical-align:-0.52em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01934em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">œÄ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6183428571428571em"><span style="top:-2.786em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mord mtight">‚à£</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">œÄ</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7633428571428571em"><span style="top:-2.931em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="mord mtight">‚à£</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7633428571428571em"><span style="top:-2.931em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mi>u</mi><mo>‚àº</mo><mtext>Uniform</mtext><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad u\sim \text{Uniform}(0,1)\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">‚àº</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Uniform</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">if</mtext><mtext>¬†</mtext></mrow><mi>u</mi><mo>&lt;</mo><mi>Œ±</mi><mrow><mtext>¬†</mtext><mtext mathvariant="bold">then</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\textbf{if }u&lt;\alpha\textbf{ then}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">if¬†</span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Œ±</span><span class="mord text"><span class="mord textbf">¬†then</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mspace width="1em"></mspace><mi>Œ∏</mi><mo>=</mo><msup><mi>Œ∏</mi><mo>‚àó</mo></msup><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\quad\theta=\theta^*\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">end</mtext><mtext>¬†</mtext><mtext mathvariant="bold">if</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\quad\textbf{end if}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">end¬†if</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mrow><mtext mathvariant="bold">end</mtext><mtext>¬†</mtext><mtext mathvariant="bold">for</mtext></mrow><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\textbf{end for}\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord textbf">end¬†for</span></span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mtext>Output¬†sample¬†</mtext><mi>Œ∏</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\quad\text{Output sample }\theta\\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord text"><span class="mord">Output¬†sample¬†</span></span><span class="mord mathnormal" style="margin-right:0.02778em">Œ∏</span></span><span class="mspace newline"></span></span></span></span>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="bold">until</mtext><mtext>¬†</mtext></mrow><mtext>Desired¬†number¬†of¬†samples</mtext></mrow><annotation encoding="application/x-tex">\textbf{until }\text{Desired number of samples}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord text"><span class="mord textbf">until¬†</span></span><span class="mord text"><span class="mord">Desired¬†number¬†of¬†samples</span></span></span></span></span></span></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="using-nmc">Using NMC<a aria-hidden="true" class="hash-link" href="#using-nmc" title="Direct link to heading">‚Äã</a></h2><p>Here is how we call NMC, where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">a</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal">b</span></span></span></span></span> are <code>real_space_alpha</code> and <code>real_space_beta</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI py"><pre tabindex="0" class="prism-code language-py codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">nmc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SingleSiteNewtonianMonteCarlo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">real_space_alpha</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> real_space_beta</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> nmc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  queries</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  observations</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_chains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To enable adaptive stage run, we can set <code>num_adaptive_samples</code> during inference.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI py"><pre tabindex="0" class="prism-code language-py codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">nmc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SingleSiteNewtonianMonteCarlo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">real_space_alpha</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> real_space_beta</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> nmc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  queries</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  observations</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_chains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_adaptive_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">num_warmup_samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For random variables with half-space and simplex support, <code>SingleSiteNewtonianMonteCarlo</code> by default uses the half-space and simplex proposer. If a modeler is interested in transforming the random variables to real space and using the unconstrained proposer instead, we can write it as follows:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI py"><pre tabindex="0" class="prism-code language-py codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">nmc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SingleSiteNewtonianMonteCarlo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">`transform_type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">``TransformType``</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">``DEFAULT`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> nmc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  queries</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  observations</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_chains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  num_adaptive_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">num_warmup_samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><hr><p>Arora, N. S., Tehrani, N. K., Shah, K. D., Tingley, M., Li, Y. L., Torabi, N., Noursi, D., Masouleh, S. A., Lippert, E., and Meijer, E. (2020). Newtonian monte carlo: single-site mcmc meets second-order gradient methods. <em>arXiv:2001.05567</em>.</p><p>Metropolis, N., Rosenbluth, A., Rosenbluth, M., Teller, A., and Teller, E. (1953). ‚ÄúEquations of state calculations by fast computing machines.‚Äù <em>J. Chem. Phys.</em>, 21(6): 1087‚Äì1092.</p><p>Robert, G., and Tweedie, R. 1996. Exponential convergence of Langevin diffusions and their discrete approximation. <em>Bernoulli</em> 2:341‚Äì363.</p><p>Girolami, M., and Calderhead, B. (2011). ‚ÄúRiemann Manifold Langevin and Hamiltonian Monte Carlo Methods: Riemann Manifold Langevin and Hamiltonian Monte Carlo Methods.‚Äù Journal of the Royal Statistical Society: Series B (Statistical Methodology) 73, no. 2 (March 2011): 123‚Äì214. <a href="https://doi.org/10.1111/j.1467-9868.2010.00765.x" target="_blank" rel="noopener noreferrer">https://doi.org/10.1111/j.1467-9868.2010.00765.x</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div></div><br><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/../docs/framework_topics/inference/newtonian_monte_carlo.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/hamiltonian_monte_carlo/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ <!-- -->Hamiltonian Monte Carlo</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/programmable_inference/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview<!-- --> ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nmc-proposers" class="table-of-contents__link toc-highlight">NMC Proposers</a><ul><li><a href="#real-space-proposer" class="table-of-contents__link toc-highlight">Real-Space Proposer</a></li><li><a href="#half-space-proposer" class="table-of-contents__link toc-highlight">Half-Space Proposer</a></li><li><a href="#simplex-proposer" class="table-of-contents__link toc-highlight">Simplex Proposer</a></li></ul></li><li><a href="#nmc-algorithm" class="table-of-contents__link toc-highlight">NMC Algorithm</a></li><li><a href="#using-nmc" class="table-of-contents__link toc-highlight">Using NMC</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c26a0145.js"></script>
<script src="/assets/js/main.badb2e6a.js"></script>
</body>
</html>