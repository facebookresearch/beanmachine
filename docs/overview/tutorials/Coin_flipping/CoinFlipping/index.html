<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-overview/tutorials/Coin_flipping/CoinFlipping">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Coin flipping | Bean Machine</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://beanmachine.org/docs/overview/tutorials/Coin_flipping/CoinFlipping/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Coin flipping | Bean Machine"><meta data-rh="true" name="description" content="&lt;LinkButtons"><meta data-rh="true" property="og:description" content="&lt;LinkButtons"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://beanmachine.org/docs/overview/tutorials/Coin_flipping/CoinFlipping/"><link data-rh="true" rel="alternate" href="https://beanmachine.org/docs/overview/tutorials/Coin_flipping/CoinFlipping/" hreflang="en"><link data-rh="true" rel="alternate" href="https://beanmachine.org/docs/overview/tutorials/Coin_flipping/CoinFlipping/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bean Machine RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bean Machine Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-47","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.2.min.js"></script>
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.2.min.js"></script><link rel="stylesheet" href="/assets/css/styles.53d6c806.css">
<link rel="preload" href="/assets/js/runtime~main.0c9215f8.js" as="script">
<link rel="preload" href="/assets/js/main.a2dc6031.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#20232a;color:#fff" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Support Ukraine ðŸ‡ºðŸ‡¦ <a target="_blank" rel="noopener noreferrer" href="https://opensource.fb.com/support-ukraine"> Help Provide Humanitarian Aid to Ukraine</a>.</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bean Machine</b></a><a class="navbar__item navbar__link" href="/docs/overview/why_bean_machine/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/overview/tutorials/Coin_flipping/CoinFlipping/">Tutorials</a><a href="/api/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookresearch/beanmachine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/overview/why_bean_machine/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/world/">Framework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/beanstalk/">Advanced</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/overview/tutorials/Coin_flipping/CoinFlipping/">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/overview/tutorials/Coin_flipping/CoinFlipping/">Coin flipping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Robust_Linear_Regression/RobustLinearRegression/">Robust linear regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Bayesian_Logistic_Regression/BayesianLogisticRegression/">Logistic regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Sparse_Logistic_Regression/SparseLogisticRegression/">Sparse logistic regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Hierarchical_regression/HierarchicalRegression/">Hierarchical regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Hierarchical_modeling/HierarchicalModeling/">Hierarchical modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Item_Response_Theory/ItemResponseTheory/">Item Response Theory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Zero_inflated_count_data/ZeroInflatedCountData/">Zero inflated count data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Hidden_Markov_model/HiddenMarkovModel/">Hidden Markov Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Bayesian_Structural_Time_Series/BayesianStructuralTimeSeries/">Bayesian Structural Time Series</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/GMM_with_2_dimensions_and_4_components/GmmWith2DimensionsAnd4Components/">Gaussian mixture model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Neals_funnel/NealsFunnel/">Neal&#x27;s funnel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Gaussian_Process_Gpytorch/GaussianProcessGpytorch/">Gaussian process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/MLE_and_MAP_point_estimation/MleAndMapPointEstimation/">MLE and MAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Automatic_differentiation_variational_inference/AutomaticDifferentiationVariationalInference/">ADVI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Bayesian_NNs_with_ADVI/BayesianNnsWithAdvi/">BNNs with ADVI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/VI_generalized_linear_mixed_model/ViGeneralizedLinearMixedModel/">VI in GLMM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/tutorials/Probabilistic_PCA/ProbabilisticPca/">Probabilistic PCA</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Coin flipping</h1></header><div class="link-buttons"><a href="https://github.com/facebookresearch/beanmachine/blob/v0.2.0/tutorials/Coin_flipping.ipynb" target="_blank" rel="noopener noreferrer">Open in GitHub</a><div></div><a href="https://colab.research.google.com/github/facebookresearch/beanmachine/blob/v0.2.0/tutorials/Coin_flipping.ipynb" target="_blank" rel="noopener noreferrer">Run in Google Colab</a></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorial-estimating-heads-rate-of-a-coin">Tutorial: <strong>Estimating heads rate of a coin</strong><a class="hash-link" href="#tutorial-estimating-heads-rate-of-a-coin" title="Direct link to heading">â€‹</a></h2><p>This tutorial demonstrates modeling and running inference on a simple coin-flipping
model in Bean Machine. This should offer an accessible introduction to fundamental
features of Bean Machine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="problem">Problem<a class="hash-link" href="#problem" title="Direct link to heading">â€‹</a></h2><p>In this tutorial, we consider the problem of estimating the probability of heads for a
potentially biased coin. In this setup, we have flipped the coin a few times and
recorded the results as training data. We&#x27;re interested in better understanding the
coin&#x27;s true heads rate.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">â€‹</a></h2><p>Let&#x27;s code this in Bean Machine! Import the Bean Machine library and some fundamental
PyTorch classes.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Install Bean Machine in Colab if using Colab.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;google.colab&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">modules </span><span class="token keyword" style="font-style:italic">and</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;beanmachine&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">modules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    !pip install beanmachine</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> arviz </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> az</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> beanmachine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ppl </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> bm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> beanmachine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ppl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">inference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">monte_carlo_samples</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pyplot </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> pandas </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">distributions </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> dist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> beanmachine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">tutorials</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">utils </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> plots</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> bokeh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">io </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> output_notebook</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> bokeh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">models </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> ColumnDataSource</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> bokeh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">palettes </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Colorblind3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> bokeh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plotting </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> gridplot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> show</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> IPython</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">display </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Markdown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> torch </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> tensor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The next cell includes convenient configuration settings to improve the notebook
presentation as well as setting a manual seed for reproducibility.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Plotting settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;figure&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> figsize</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;font&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> size</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lines&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> linewidth</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Manual seed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">seed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">manual_seed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">11</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Other settings for the notebook.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">smoke_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;SANDCASTLE_NEXUS&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">environ </span><span class="token keyword" style="font-style:italic">or</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CI&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">environ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Plotting settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">az</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rcParams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;plot.backend&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bokeh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">az</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rcParams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;stats.hdi_prob&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.89</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="model">Model<a class="hash-link" href="#model" title="Direct link to heading">â€‹</a></h2><p>We have the following definitions.</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\theta \in [0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>: Heads rate of the coin.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">y_i \in \{0, 1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span>: Result of the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em"></span><span class="mord mathnormal">i</span></span></span></span></span>th coin flip. This is usually an observed value.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>âˆˆ</mo><msup><mi mathvariant="double-struck">Z</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">N \in \mathbb{Z}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span>: Number of observed coin flips.</li></ul><p>We&#x27;re interested in modeling:</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mi mathvariant="normal">âˆ£</mi><mo stretchy="false">{</mo><msub><mi>y</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{P}(\theta | \{y_i\}_{i=1}^N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0999949999999998em;vertical-align:-0.258664em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span><span class="mord">âˆ£</span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li></ul><p>In Bayesian modeling, we encode our initial understanding of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span> by specifying a
prior distribution for it <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{P}(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span><span class="mclose">)</span></span></span></span></span>. We then describe the relationship
between the unobserved random variable <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>, and the observed random variables
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>y</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">\{y_i\}_{i=1}^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0999949999999998em;vertical-align:-0.258664em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em"><span></span></span></span></span></span></span></span></span></span></span>. We can do this as follows:</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>âˆ¼</mo><mtext>Beta</mtext><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\theta \sim \text{Beta}(2, 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Beta</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo><mover><mo><mo>âˆ¼</mo></mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover></mo><mtext>Bernoulli</mtext><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_i \stackrel{iid}{\sim} \text{Bernoulli}(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.347418em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.152978em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">âˆ¼</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Bernoulli</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span><span class="mclose">)</span></span></span></span></span></li></ul><p>These will later combine to form the posterior distribution
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">P</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mi mathvariant="normal">âˆ£</mi><mo stretchy="false">{</mo><msub><mi>y</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{P}(\theta | \{y_i\}_{i=1}^N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0999949999999998em;vertical-align:-0.258664em"></span><span class="mord"><span class="mord mathbb">P</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span><span class="mord">âˆ£</span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> which encodes our improved understanding of
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>.</p><p>As a convention, we will consider an outcome of 1 from the Bernoulli distribution to
represent heads and zero to represent tails. Here we chose to use a Beta distribution
for the prior distribution for the coin&#x27;s probability of heads, but in principle any
distribution over <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> can be used.</p><p>Let&#x27;s visualize the particular Beta distribution used in this tutorial:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">thetas </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">arange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">thetas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Beta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">log_prob</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">thetas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">exp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">xlabel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">r&quot;$\theta$&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ylabel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">r&quot;$\mathbb{P}(\theta)$&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></p><p>We can implement this model in Bean Machine by defining random variable objects with the
<code>@bm.random_variable</code> decorator. These functions behave differently than ordinary Python
functions.</p><div style="background:#daeaf3;border_left:3px solid #2980b9;display:block;margin:16px 0;padding:12px">Semantics for <code>@bm.random_variable</code> functions:<ul><li>They must return PyTorch <code>Distribution</code> objects.</li><li>Though they return distributions, callees actually receive a <i>sample</i> from the distribution. The machinery for obtaining samples from distributions is handled internally by Bean Machine.</li><li>Inference runs the model through many iterations. During a particular inference iteration, a distinct random variable will correspond to exactly one sampled value: <b>calls to the same random variable function with the same arguments will receive the same sampled value within one inference iteration</b>. This makes it easy for multiple components of your model to refer to the same logical random variable.</li><li>Consequently, to define distinct random variables that correspond to different sampled values during a particular inference iteration, an effective practice is to add a dummy &quot;indexing&quot; parameter to the function. Distinct random variables can be referred to with different values for this index.</li><li>Please see the documentation for more information about this decorator.</li></ul><p>Semantics for <code>@bm.random_variable</code> functions:</p><ul><li>This is a decorator that let&#x27;s you treat deterministic code as if it&#x27;s a Bean Machine random variable. This is used to transform the results of one or more random variables.</li><li>This follows the same naming practice as <code>@bm.random_variable</code> where variables are distinguished by their argument call values.</li></ul></div><p>First, let&#x27;s define our prior for the heads rate, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>, using this syntax:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@bm</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">random_variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> dist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Beta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similarly, let&#x27;s define a random variables for the observed values, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@bm</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">random_variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> dist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bernoulli</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The mathematical definitions map directly to the Python definitions.</p><p>In contrast to <code>theta()</code>, notice that <code>y(i)</code> defines a dummy indexing parameter <code>i</code>.
That&#x27;s because <code>y(i)</code> is actually defining a <em>family</em> of random variables -- one for
each observed coin flip! This allows us to refer to specific observations as <code>y(0)</code>,
<code>y(1)</code>, and so on.</p><p>In the above examples, we&#x27;ve defined our random variable functions in the toplevel for
convenience. It&#x27;s worth noting that Bean Machine models can be packaged into Python
classes and instantiated as needed. This essentially namespaces random variables defined
within, since the <code>self</code> argument that each random variable receives will be associated
with the distinct instantiated class that it&#x27;s a part of. Example code is included as an
illustration below; however, this tutorial will continue to use the toplevel
definitions.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">HeadsRateModel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@bm</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">random_variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> dist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Beta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@bm</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">random_variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> dist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bernoulli</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">heads_rate_model </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> HeadsRateModel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data">Data<a class="hash-link" href="#data" title="Direct link to heading">â€‹</a></h2><p>With the model defined, we need to collect some observed data in order to learn about
values of interest in our model.</p><p>In this case, we will observe a few coin flips. For demonstrative purposes, we will use
a synthetically generated dataset of observed values. In practice, you would flip a real
coin and record observations instead.</p><p>For our synthetic dataset, we will assume a true heads rate of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.75</mn></mrow><annotation encoding="application/x-tex">0.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">5</span></span></span></span></span>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">true_theta </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.75</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">true_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> dist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Bernoulli</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">true_theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, we&#x27;ll gather <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span><span class="mord">0</span></span></span></span></span> observations from flipping that coin.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">N </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_obs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> true_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">N</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="background-color:lightgray;margin-bottom:var(--ifm-leading);border-radius:var(--ifm-global-radius);box-shadow:var(--ifm-global-shadow-lw);overflow:hidden;padding:10px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit"><p style="margin-bottom:0px">tensor(1.)</p></pre></div><p>Let&#x27;s analyze the dataset:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> bins</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">xticks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0.25</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.75</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Tails&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Heads&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Empirical heads rate: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">y_obs</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">mean</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,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" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="inference">Inference<a class="hash-link" href="#inference" title="Direct link to heading">â€‹</a></h2><p>Inference is the process of combining <em>model</em> and <em>data</em> to obtain <em>insights</em>, in the
form of probability distributions over values of interest. Bean Machine offers a
powerful and general inference framework to enable fitting a arbitrary models to data.</p><p>Our inference algorithms expect observations in the form of a dictionary. This
dictionary should consist of <code>@bm.random_variable</code> invocations as keys, and tensor data
as values. You can see this in the example below:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">observations </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, we&#x27;re ready to run inference! For this very simple tutorial, we&#x27;ll use the simple
Metropolis-Hastings inference algorithm. Check out the documentation or other tutorials
for more advanced examples!</p><p>Running inference consists of a few arguments:</p><table><thead><tr><th>Name</th><th>Usage</th></tr></thead><tbody><tr><td><code>queries</code></td><td>List of <code>@bm.random_variable</code> targets to fit posterior distributions for.</td></tr><tr><td><code>observations</code></td><td>A dictionary of observations.</td></tr><tr><td><code>num_samples</code></td><td>Number of Monte Carlo samples to approximate the posterior distributions for the variables in queries.</td></tr><tr><td><code>num_chains</code></td><td>Number of separate inference runs to use. Multiple chains can help verify that inference ran correctly.</td></tr></tbody></table><p>Let&#x27;s run inference:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">num_samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> smoke_test </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> bm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SingleSiteAncestralMetropolisHastings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    queries</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    observations</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">observations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    num_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">num_samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    num_chains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="background-color:lightgray;margin-bottom:var(--ifm-leading);border-radius:var(--ifm-global-radius);box-shadow:var(--ifm-global-shadow-lw);overflow:hidden;padding:10px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit"><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p></pre></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">â€‹</a></h2><p><code>samples</code> now contains our inference results. Although we ran inference only to compute
distributions for <code>theta()</code>, in general you can compute distributions for many variables
at once. So, you have to index into this object using the random variable syntax we&#x27;ve
seen several times. Here&#x27;s an example:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">theta_for_four_chains </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">detach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">theta_for_four_chains</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="background-color:lightgray;margin-bottom:var(--ifm-leading);border-radius:var(--ifm-global-radius);box-shadow:var(--ifm-global-shadow-lw);overflow:hidden;padding:10px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit"><p style="margin-bottom:0px">tensor([[0.7710, 0.7710, 0.7710,  ..., 0.8267, 0.8267, 0.8086],</p><p style="margin-bottom:0px">        [0.2854, 0.2854, 0.7474,  ..., 0.7243, 0.7243, 0.7865],</p><p style="margin-bottom:0px">        [0.8248, 0.7088, 0.7088,  ..., 0.7886, 0.7886, 0.7886],</p><p style="margin-bottom:0px">        [0.6676, 0.7408, 0.6948,  ..., 0.7648, 0.7648, 0.7648]])</p></pre></div><p>Results from all four separate inference runs are stored in here. We&#x27;ll use them later;
for now, let&#x27;s just examine one of these runs:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">theta_for_first_chain </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> theta_for_four_chains</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">theta_for_first_chain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">axvline</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">true_theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;red&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;True theta = </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">true_theta </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.03f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">axvline</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_obs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lightgreen&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Empirical heads rate = </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">y_obs</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">mean</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.03f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">axvline</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    theta_for_first_chain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lightblue&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Posterior mean = </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">theta_for_first_chain</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">mean</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.03f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAFpCAYAAABwEjqZAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAA7xklEQVR4nO3deVyU5f7/8dclIAguiQuLiGZuiUXuaaWZR091NCszt7TU7JSmlZWGbUrlUqmVhZplaeWvRa0sO1p5vpoZLkeMdrMjiprielxAAeH+/THDxLAoy8Dgzfv5eMwDue/rvu7rMzPynnsdY1kWIiIiYi9VvD0AERER8TwFvIiIiA0p4EVERGxIAS8iImJDCngREREbUsCLiIjYkK+3B1AUa9eutfz9/fNNP336NNWqVfPCiLyvstZeWesG1X6+2tPOZnPWAl8Dgb6e2XapsmMH5tQprOrVyW7WzCN9FtVxjnOWs/jiSy1qleu6K4LK/n63LOtwjx496pWmnwsi4P39/WnZsmW+6QkJCQVOrwwqa+2VtW5Q7eerfduxdFIzLS7yM7SsnX+DoCSqP/oofhs2kHnVVZz67DOP9FlUq1lNCimEEEInOpXruiuCyv5+B3aXth/tohcREbEhBbyIiIgNKeBFRERsSAEvIiJiQwp4ERERG7ogzqI/n/T0dM6cOYMxxttDKTe1a9fmxIkT3h5GuausdYNqz127ZVkEBARQ0OWzIuJwwQd8amoqADVr1qxUAe/j40NQUJC3h1HuKmvdoNpz125ZFmlpaZw9e7bSPici53PB76LPysoiKCioUoW7SGVnjCEoKIisrCxvD0WkwrrgA15ERETyU8CLiIjYkAJeRETEhhTwkk+fPn2YMGGCt4chIiKloIAvZ8HBwed8jBkzptzG8u233xIcHMyRI0cuqL5L4pdffqF3796Eh4cTFRXF888/j2VZhbbPGX9Bj08++cTVLjo6Ot/8KVOmuPW1d+9eBg0aREREBE2bNuWxxx4jIyOjrEoVEQFscJnchebXX391/Xv16tU8+OCDbtPyfj1iZmYmfn5+5TY+Ozpx4gS33nornTt35uuvv2bHjh2MHTuWwMBA7r///gKX6dixo9vrAvD666+zYMEC/va3v7lNf/TRRxkxYoTr99yXbWVlZTFgwACCg4NZuXIlR48eZcyYMViWxYwZMzxYZeW0ZsdR5m77LwCDu0TSqG4QiftPMXHZLx7pf97+U7QDfth/invf2FaiPr68u41HxiJSXNqCL2chISGuR61atdympaen07hxY5YtW0bfvn0JDw/n7bffZsmSJTRs2NCtn/j4+HxbyJs2baJ37940aNCAqKgoHn744UJvjJKcnMxNN90EQLNmzfLtPcjOzuaZZ56hadOmNG/enCeffJLs7GzX/IyMDCZPnkxUVBQNGjSgR48erFmz5rx9f/3119x4441cfPHFNGnShH79+rF9+/bSPq3ntHTpUtLS0oiLi6NVq1b07duXcePGMXfu3EK34qtWrer2WoWEhLBixQpuvfVWqlev7ta2evXqbu1yz//3v//Nb7/9xty5c4mOjqZ79+5MnjyZxYsXV9qb1ohI+bDdFny1mBh8fvqp3Neb1bo1p6dN80hfsbGxxMbG8sorr+Dr68u6devOu8wvv/zCbbfdxsSJE3n55Zc5duwYkyZNYuzYsSxatChf+wYNGrBo0SLuvPNOvvvuO2rXru229+Cjjz7in//8J6tWreLHH3/knnvu4YorrqBfv34A3H///SQlJbFgwQLCw8P56quvGDx4MGvWrOHSSy8ttO+0tDTuvfdeoqKiOHPmDC+++CKDBw8mPj6eqlWrFljbRx99xPjx4wHHDU4KuufBrFmz6N+/f4HLb9myhc6dO7vVd9111zF16lSSk5Np1KjReZ/fb7/9lv/+97+8/vrr+ea99tprvPTSSzRo0IC+ffsyduxYVy1btmyhefPmREREuK07PT2dxMRErrnmmvOuW0SkJGwX8D4//YTfhg3eHkapjBo1ir59+xZrmTlz5nDzzTe77XKeOXMm3bp149ChQ9SrV8+tvY+PD7Vr1wagXr161KlTx21+ixYtmDRpEgBNmzZl8eLFrFu3jn79+pGUlMSyZctITEx0BdeoUaNYt24db7/9Ni+++GKhfeds2ed49dVXadSoEQkJCVx55ZUF1nb99dfTrl07wPEBITAwMF+bvPXllpKSQnh4uNu0+vXru+YVJeAXLVrEZZddRps27rtb77nnHi6//HKCg4PZunUrsbGx7N69m1deeQWAgwcPutaVo06dOvj4+HDw4MHzrldEpKRsF/BZrVtf8OvNGyJF8f3335OUlOR2AljO7uekpKRzBmBBoqKi3H4PCwvj8OHDACQmJmJZFp07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qF+/foHzT506xdy5c5k6dSp33HEHAE2aNKFjx46uNo8++qjr35GRkYwfP55XX3212AE/YMAAbr/9dsCx23b+/Pl899133H777Sxfvty1JyHnw8rs2bNp3rw5q1ev5pZbbqF169a0bv3XDqaHH36YVatWsWLFCh555BH++OMPvv76a7744gvXcxQXF0ebNn/9gdu7dy+BgYFcf/311KhRg4YNG7r1WZhRo0bRt29ft2njxo1z/fuuu+5i/fr1LFu2jG7dulGzZk2qVq1KYGAgISEhrnYLFy6kdevWbu+FuXPn0qRJE7Zt20a7du0KXP+HH354zkMDfn5+hc5LSXH8n8n7HqhXrx779+8vdLl+/fpx7NgxevfujWVZnD17lgEDBrjGfuTIEbKysgrsd926dQAcPHgQHx8f13s4R/369ct0r4WI3RVlCz6vGjh27R9z/n4xEAp8mdPAsqzTxphvgC7AfKAzcAr4Llc/G4BUZxuPBXwwwZ7qqkzX26VLF2bPnu02Le8x76iov45y5PyBbNWqlWtazrH0Q4cOuf44VqlSxS0AGjZsSGhoKNu3by804MPDwwsNd4Dt27eTnp5O165dC23z6aefMm/ePJKSkkhNTSUrK6tEx09z1+zr60udOnU4dOgQAImJiezZs4fIyEi3ZdLS0lyHIVJTU3n++edZvXo1KSkpnD17ljNnzrj6/f333wt9jnJce+21NGzYkDZt2nDdddfRvXt3evfuTY0aNc459twfEgCysrJ46aWX+Pjjj9m/fz8ZGRlkZGRw1VVXnbOfxMREvvvuuwKvOti1a1ehAV+UqyM8bcOGDbz44ou88MILtG/fnp07dxITE8O0adOYNGlSuY9HRP5SkoB/GfgeyNnXl/OXMe9mcwrQIFebQ5ZlWTkzLcuyjDEHcy3vxhhzD3APwLJly0hLS8vXJi0tjSNHjuDj4+Oa1opW+dqVl1RSi9QuMzOTqlWrum21ufpI/auPrKws1++nT592m5adne06xp2amkpqairp6emA43nx9f3rpbUsi4yMDFcby7Jc/WZmZhIQEOC23pzpOevKWffp06fztQNISEjg7rvv5sEHH+SJJ56gVq1afPnllzz77LOu9nnXW5jcNec4c+aMa+ytWrXitddey7fcRRddRGpqKjExMaxbt44nnniCiy++mICAAB566CHS0tJITU11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dDTx8fFs3LiRb775htGjR9O6dWuWL19eaMhnZ2czdOhQty3bHDmBBxAUFFTCinDb6s05GawocmrP3UfeaTnH13N+zpw5k44dOxbY3549exg4cCDDhg0jJiaG4OBgEhMTGTVqlOswCICvr/vbP2fduY/l51WaXfR16tTBx8cn32t86NChIn8YWrx4MX369Cn0A0hRZGRk8P777zNs2LB8z4GI2If+d3tJtWrVaNKkSb7pjRs3pmrVqmzatImLL74YgKysLLZs2UK/fv1c7apXr07fvn3p27cvgwYNolevXuzcuZOmTZtStWrVfCEVHR3Nb7/9VuA6i6N58+YcOHCA5ORk11b8rl27OHDgAC1atChV30VRr149wsLCSEpKYuDAgQW22bZtGxkZGTz33HP4+PgAsHr1ao+svzS76KtWrUp0dDRr1651O3N97dq19OnT57zLb9u2jZ9++ompU6eWaP05Vq5cyZEjR7jjjjtK1Y+IVGwK+AomKCiI4cOHM2XKFOrUqUNkZCRz587l0KFDrmvRX3vtNS666CLat2+Pn58fS5cupUaNGq7dxw0bNiQ+Pp7+/fvj7+/vunyqV69ejB8/nrvuuovq1auzY8cOVq1axezZs4s8vmuvvZaoqCjuuecepk2bBsDEiROJjo6ma9eunn9CCjBx4kQee+wxatWqRc+ePcnMzOSHH35g//79PPTQQ1xyySVkZ2czd+5c+vTpw3/+8x+3k+tKo7S76EePHs19991H27Zt6dSpE2+99RYHDhxg+PDhrjY5e1nmzp3rtuySJUu45JJLuPrqqwvs+8cffwTg5MmTVKlShR9//BE/Pz9atmzp1m7x4sV07dqVxo0bl6oWEanYFPAV0OTJkwHHSV/Hjx/nsssu46OPPiI0NBRwbL3Pnz+fmJgYAC6//HI+/PBD127xmJgYxo8fT7t27UhPT+fo0aNERUXx+eef89xzz9G7d2+ys7Np1KgR//jHP4o1NmMM7733Ho899pjrJLdu3boxffr0crvOfdiwYQQFBTFnzhyeeeYZAgICaNmyJXfffTfgOKY/bdo0XnnlFaZOnUrHjh2JjY2tEDfrufXWWzl27BgzZ84kJSWFSy+9lA8++ICGDRu62uzduzffcidPnmTFihVMmDCh0L67devm9vuqVato2LAhiYmJrmm7du3im2++4Y033vBANSJS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" class="img_ev3q"></p><p>The graph above is based on pseudo-randomly generated data, so, the results can be
varied by changing the seed. Typically,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;!--</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>the true <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span> will remain within the main non-zero probability part of the
histogram, but may not necessarily fall in the modal interval of the histogram. More
generally, for this particular problem, we can expect
--&gt;
the mean of inferred distribution will be closer to 0.5 than the true <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>. This is
because 0.5 is the mean of our prior for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>.</p><p>Arviz provides helpful statistics about the result of the inference algorithm. We can
query this information as follows:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Markdown</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">az</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">summary</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_inference_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> round_to</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_markdown</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th align="left"></th><th align="right">mean</th><th align="right">sd</th><th align="right">hdi_5.5%</th><th align="right">hdi_94.5%</th><th align="right">mcse_mean</th><th align="right">mcse_sd</th><th align="right">ess_bulk</th><th align="right">ess_tail</th><th align="right">r_hat</th></tr></thead><tbody><tr><td align="left">theta()</td><td align="right">0.7161</td><td align="right">0.1154</td><td align="right">0.5527</td><td align="right">0.9035</td><td align="right">0.0036</td><td align="right">0.0025</td><td align="right">1051.7</td><td align="right">914.083</td><td align="right">1.006</td></tr></tbody></table><p>As is suggested by the visualization, the average and the median are around <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.72</mn></mrow><annotation encoding="application/x-tex">0.72</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">2</span></span></span></span></span>.
Moreover, 95% of the samples fall within the interval <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0.460</mn><mo separator="true">,</mo><mn>0.904</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0.460, 0.904]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">6</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mord">4</span><span class="mclose">]</span></span></span></span></span>. The width of
this interval reflects the reality that we have conditions on few observations, and so
should be quite uncertain about the true <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>.</p><p>As is suggested by the visualization, the average and the median are around <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.72</mn></mrow><annotation encoding="application/x-tex">0.72</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">2</span></span></span></span></span>.
Moreover, 95% of the samples fall within the interval <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0.460</mn><mo separator="true">,</mo><mn>0.904</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0.460, 0.904]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mord">6</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">0</span><span class="mord">4</span><span class="mclose">]</span></span></span></span></span>. The width of
this interval reflects the reality that we have conditions on few observations, and so
should be quite uncertain about the true <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">Î¸</span></span></span></span></span>.</p><p>The summary output shows two diagnostic statistics:
<a href="https://projecteuclid.org/euclid.ss/1177011136" target="_blank" rel="noopener noreferrer"><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>R</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9467699999999999em;vertical-align:0em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.16666em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span></a> (<code>r_hat</code>) and
<a href="https://www.mcmchandbook.net/HandbookChapter1.pdf" target="_blank" rel="noopener noreferrer"><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>eff</mtext></msub></mrow><annotation encoding="application/x-tex">N_\text{eff}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">eff</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></a> (effective sample
size, <code>n_eff</code>).</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>R</mi><mo>^</mo></mover><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">âˆž</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{R} \in [1, \infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9858699999999999em;vertical-align:-0.0391em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.16666em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">âˆž</span><span class="mclose">)</span></span></span></span></span> summarizes how effective inference was at converging on the
correct posterior distribution for a particular random variable. It uses information
from all chains run in order to assess whether inference had a good understanding of
the distribution or not. Values very close to zero indicate that all chains discovered
similar distributions for a particular random variable. We do not recommend using
inference results where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>R</mi><mo>^</mo></mover><mo>&gt;</mo><mn>1.1</mn></mrow><annotation encoding="application/x-tex">\hat{R} &gt; 1.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9858699999999999em;vertical-align:-0.0391em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.16666em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">1</span></span></span></span></span>, as inference may not have converged. In that
case, you may want to run inference for more samples.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>eff</mtext></msub><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mtext mathvariant="monospace">num</mtext><mi mathvariant="normal">_</mi><mtext mathvariant="monospace">samples</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">N_\text{eff} \in [1, \texttt{num}\_\texttt{samples}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">eff</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord text"><span class="mord texttt">num</span></span><span class="mord" style="margin-right:0.02778em">_</span><span class="mord text"><span class="mord texttt">samples</span></span><span class="mclose">]</span></span></span></span></span> summarizes how independent
posterior samples are from one another. Although inference was run for <code>num_samples</code>
iterations, it&#x27;s possible that those samples were very similar to each other (due to
the way inference is implemented), and may not each be representative of the full
posterior space. Larger numbers are better here, and if your particular use case calls
for a certain number of samples to be considered, you should ensure that
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>eff</mtext></msub></mrow><annotation encoding="application/x-tex">N_\text{eff}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">eff</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is at least that large.</li></ul><p>In this case, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>R</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9467699999999999em;vertical-align:0em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span><span style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.16666em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>eff</mtext></msub></mrow><annotation encoding="application/x-tex">N_\text{eff}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">eff</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> seem to have acceptable values.</p><p>Bean Machine can also plot diagnostical information to assess model fit. Let&#x27;s take a
look:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Required for visualizing in Colab.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">output_notebook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hide_banner</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples_diagnostic_plots </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gridplot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">plots</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plot_diagnostics</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">show</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">samples_diagnostic_plots</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="bk-root thin-scrollbar" id="samples-diagnostic-plots" style="overflow:auto;width:100%"><div>loading...</div></div><p>The diagnostics output shows two diagnostic plots for individual random variables: trace
plots and autocorrelation plots.</p><ul><li>Trace plots are simply a time series of values assigned to random variables over each
iteration of inference. The concrete values assigned are usually problem-specific.
However, it&#x27;s important that these values are &quot;mixing&quot; well over time. This means that
they don&#x27;t tend to get stuck in one region for large periods of time, and that each of
the chains ends up exploring the same space as the other chains throughout the course
of inference.</li><li>Autocorrelation plots measure how predictive the last several samples are of the
current sample. Autocorrelation may vary between -1.0 (deterministically
anticorrelated) and 1.0 (deterministically correlated). (We compute autocorrelation
approximately, so it may sometimes exceed these bounds.) In an ideal world, the
current sample is chosen independently of the previous samples: an autocorrelation of
zero. This is not possible in practice, due to stochastic noise and the mechanics of
how inference works.</li></ul><p>From the trace plots, we see each of the chains are healthy: they don&#x27;t get stuck, and
do not explore a chain-specific subset of the space. From the autocorrelation plots, we
see the absolute magnitude of autocorrelation to be very small, often around 0.1,
indicating a healthy exploration of the space.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bmginference">BMGInference<a class="hash-link" href="#bmginference" title="Direct link to heading">â€‹</a></h2><p>Bean Machine Graph (BMG) Inference is an experimental feature of the Bean Machine
framework that aims to deliver higher performance for specialized models. The model used
in this tutorial represents a static probabilistic graph model and happens to use only
features within the language subset supported by <code>BMGInference</code>. Currently, however,
only Newtonian Monte Carlo (NMC) inference is supported by <code>BMGInference</code>. So, as a
reference point, the following code reports the time it takes for our basic
implementation of NMC to compute the posterior:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain">time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> bm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SingleSiteNewtonianMonteCarlo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    queries</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    observations</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">observations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    num_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">num_samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    num_chains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="background-color:lightgray;margin-bottom:var(--ifm-leading);border-radius:var(--ifm-global-radius);box-shadow:var(--ifm-global-shadow-lw);overflow:hidden;padding:10px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit"><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">Samples collected:   0%|          | 0/1000 [00:00&lt;?, ?it/s]</p><p style="margin-bottom:0px">CPU times: user 10.7 s, sys: 68 ms, total: 10.8 s</p><p style="margin-bottom:0px">Wall time: 10.8 s</p></pre></div><p>To run our model using <code>BMGInference</code>, the only change needed is the following:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token operator" style="color:rgb(137, 221, 255)">%</span><span class="token plain">time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> beanmachine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ppl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">inference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">bmg_inference </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> BMGInference</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples_bmg </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> BMGInference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    queries</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">theta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    observations</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">observations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    num_samples</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">num_samples</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    num_chains</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="background-color:lightgray;margin-bottom:var(--ifm-leading);border-radius:var(--ifm-global-radius);box-shadow:var(--ifm-global-shadow-lw);overflow:hidden;padding:10px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit"><p style="margin-bottom:0px">0%   10   20   30   40   50   60   70   80   90   100%</p><p style="margin-bottom:0px">|----|----|----|----|----|----|----|----|----|----|</p><p style="margin-bottom:0px">CPU times: user 1.5 s, sys: 11.8 ms, total: 1.51 s</p><p style="margin-bottom:0px">Wall time: 1.51 s</p><p style="margin-bottom:0px">***************************************************</p></pre></div><p>Wall time numbers will naturally vary on different platforms, but with with these
parameters (model, observations, queries, sample size, and number of chains) speedup on
the author&#x27;s machine is about 40x. Generally speaking, larger speedups are expected with
larger sample sizes. More information about <code>BMGInference</code> can be found on the website
in &quot;Advanced&quot; section of the documentation.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebookresearch/beanmachine/edit/main/website/../docs/overview/tutorials/Coin_flipping/CoinFlipping.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/beanstalk/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bean Machine Graph Inference</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/overview/tutorials/Robust_Linear_Regression/RobustLinearRegression/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Robust linear regression</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tutorial-estimating-heads-rate-of-a-coin" class="table-of-contents__link toc-highlight">Tutorial: <strong>Estimating heads rate of a coin</strong></a></li><li><a href="#problem" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#model" class="table-of-contents__link toc-highlight">Model</a></li><li><a href="#data" class="table-of-contents__link toc-highlight">Data</a></li><li><a href="#inference" class="table-of-contents__link toc-highlight">Inference</a></li><li><a href="#analysis" class="table-of-contents__link toc-highlight">Analysis</a></li><li><a href="#bmginference" class="table-of-contents__link toc-highlight">BMGInference</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/beanmachine.svg" alt="Bean Machine Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright &#169; 2022 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0c9215f8.js"></script>
<script src="/assets/js/main.a2dc6031.js"></script>
</body>
</html>